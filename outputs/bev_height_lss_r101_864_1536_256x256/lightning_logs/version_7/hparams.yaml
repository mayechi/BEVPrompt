gpus: 1
data_root: data/dair-v2x-i/
eval_interval: 1
batch_size_per_device: 1
class_names:
- Vehicle
- Cyclist
- Pedestrian
backbone_conf:
  x_bound:
  - 0
  - 102.4
  - 0.4
  y_bound:
  - -51.2
  - 51.2
  - 0.4
  z_bound:
  - -5
  - 3
  - 8
  d_bound:
  - -2.0
  - 0.0
  - 90
  final_dim:
  - 864
  - 1536
  output_channels: 80
  downsample_factor: 16
  img_backbone_conf:
    type: ResNet
    depth: 101
    frozen_stages: 0
    out_indices:
    - 0
    - 1
    - 2
    - 3
    norm_eval: false
    init_cfg:
      type: Pretrained
      checkpoint: torchvision://resnet101
  img_neck_conf:
    type: SECONDFPN
    in_channels:
    - 256
    - 512
    - 1024
    - 2048
    upsample_strides:
    - 0.25
    - 0.5
    - 1
    - 2
    out_channels:
    - 128
    - 128
    - 128
    - 128
  height_net_conf:
    in_channels: 512
    mid_channels: 512
head_conf:
  bev_backbone_conf:
    type: ResNet
    in_channels: 80
    depth: 18
    num_stages: 3
    strides:
    - 1
    - 2
    - 2
    dilations:
    - 1
    - 1
    - 1
    out_indices:
    - 0
    - 1
    - 2
    norm_eval: false
    base_channels: 160
  bev_neck_conf:
    type: SECONDFPN
    in_channels:
    - 80
    - 160
    - 320
    - 640
    upsample_strides:
    - 1
    - 2
    - 4
    - 8
    out_channels:
    - 64
    - 64
    - 64
    - 64
  tasks:
  - num_class: 1
    class_names:
    - Vehicle
  - num_class: 1
    class_names:
    - Cyclist
  - num_class: 1
    class_names:
    - Pedestrian
  common_heads:
    reg:
    - 2
    - 2
    height:
    - 1
    - 2
    dim:
    - 3
    - 2
    rot:
    - 2
    - 2
    vel:
    - 2
    - 2
  bbox_coder:
    type: CenterPointBBoxCoder
    post_center_range:
    - 0.0
    - -50.4
    - -10.0
    - 102.4
    - 50.4
    - 10.0
    max_num: 500
    score_threshold: 0.1
    out_size_factor: 4
    voxel_size:
    - 0.1
    - 0.1
    - 8
    pc_range:
    - 0
    - -50.4
    - -5
    - 102.4
    - 50.4
    - 3
    code_size: 9
  train_cfg:
    point_cloud_range:
    - 0
    - -50.4
    - -5
    - 102.4
    - 50.4
    - 3
    grid_size:
    - 1024
    - 1024
    - 1
    voxel_size:
    - 0.1
    - 0.1
    - 8
    out_size_factor: 4
    dense_reg: 1
    gaussian_overlap: 0.1
    max_objs: 500
    min_radius: 2
    code_weights:
    - 1.0
    - 1.0
    - 1.0
    - 1.0
    - 1.0
    - 1.0
    - 1.0
    - 1.0
    - 0.5
    - 0.5
  test_cfg:
    post_center_limit_range:
    - 0.0
    - -50.4
    - -10.0
    - 102.4
    - 50.4
    - 10.0
    max_per_img: 500
    max_pool_nms: false
    min_radius:
    - 4
    - 0.85
    - 0.175
    score_threshold: 0.1
    out_size_factor: 4
    voxel_size:
    - 0.1
    - 0.1
    - 8
    nms_type: circle
    pre_max_size: 1000
    post_max_size: 83
    nms_thr: 0.2
  in_channels: 256
  loss_cls:
    type: GaussianFocalLoss
    reduction: mean
  loss_bbox:
    type: L1Loss
    reduction: mean
    loss_weight: 0.25
  gaussian_overlap: 0.1
  min_radius: 2
ida_aug_conf:
  final_dim:
  - 864
  - 1536
  H: 1080
  W: 1920
  bot_pct_lim:
  - 0.0
  - 0.0
  cams:
  - CAM_FRONT
  Ncams: 1
default_root_dir: ./outputs/bev_height_lss_r101_864_1536_256x256
logger: true
checkpoint_callback: null
enable_checkpointing: true
gradient_clip_val: 5
gradient_clip_algorithm: null
process_position: 0
num_nodes: 1
num_processes: 1
devices: null
auto_select_gpus: false
tpu_cores: null
ipus: null
log_gpu_memory: null
progress_bar_refresh_rate: null
enable_progress_bar: true
overfit_batches: 0.0
track_grad_norm: -1
check_val_every_n_epoch: 1
fast_dev_run: false
accumulate_grad_batches: null
max_epochs: 60
min_epochs: null
max_steps: -1
min_steps: null
max_time: null
limit_train_batches: 1.0
limit_val_batches: 0
limit_test_batches: 1.0
limit_predict_batches: 1.0
val_check_interval: 1.0
flush_logs_every_n_steps: null
log_every_n_steps: 50
accelerator: ddp
strategy: null
sync_batchnorm: false
precision: 32
enable_model_summary: true
weights_summary: top
weights_save_path: null
num_sanity_val_steps: 0
resume_from_checkpoint: null
profiler: simple
benchmark: false
deterministic: false
reload_dataloaders_every_n_epochs: 0
reload_dataloaders_every_epoch: false
auto_lr_find: false
replace_sampler_ddp: true
detect_anomaly: false
auto_scale_batch_size: false
prepare_data_per_node: null
plugins: null
amp_backend: native
amp_level: null
move_metrics_to_cpu: false
multiple_trainloader_mode: max_size_cycle
stochastic_weight_avg: false
terminate_on_nan: null
evaluate: true
seed: 0
ckpt_path: /home/zjlab/mayechi/code/BEVHeight/outputs/bev_height_lss_r101_864_1536_256x256_44/checkpoints/epoch=4_TP+FP_loss.ckpt
